<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Computations &mdash; reikna 0.2.4 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="reikna 0.2.4 documentation" href="../index.html" />
    <link rel="up" title="API reference" href="index.html" />
    <link rel="next" title="Transformations" href="transformations.html" />
    <link rel="prev" title="Core classes" href="core.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="Transformations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="core.html" title="Core classes"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">reikna 0.2.4 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">API reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="computations">
<h1>Computations<a class="headerlink" href="#computations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-reikna.elementwise">
<span id="elementwise-computations"></span><h2>Elementwise computations<a class="headerlink" href="#module-reikna.elementwise" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.elementwise.Elementwise">
<em class="property">class </em><tt class="descclassname">reikna.elementwise.</tt><tt class="descname">Elementwise</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.elementwise.Elementwise" title="Permalink to this definition">¶</a></dt>
<dd><p>A general class for elementwise computations.</p>
<dl class="method">
<dt id="reikna.elementwise.Elementwise.set_argnames">
<tt class="descname">set_argnames</tt><big>(</big><em>outputs</em>, <em>inputs</em>, <em>scalars</em><big>)</big><a class="headerlink" href="#reikna.elementwise.Elementwise.set_argnames" title="Permalink to this definition">¶</a></dt>
<dd><p>Set argument names for the computation.
This method should be called first after the creation of the
<a class="reference internal" href="#reikna.elementwise.Elementwise" title="reikna.elementwise.Elementwise"><tt class="xref py py-class docutils literal"><span class="pre">Elementwise</span></tt></a> object.
Returns <tt class="docutils literal"><span class="pre">self</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="reikna.elementwise.Elementwise.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>*args</em>, <em>code=EMPTY</em><big>)</big><a class="headerlink" href="#reikna.elementwise.Elementwise.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>args</strong> &#8211; arrays and scalars, according to the lists passed to <a class="reference internal" href="#reikna.elementwise.Elementwise.set_argnames" title="reikna.elementwise.Elementwise.set_argnames"><tt class="xref py py-meth docutils literal"><span class="pre">set_argnames()</span></tt></a>.</li>
<li><strong>code</strong> &#8211; a function that takes argument mocks as parameters and returns
a snippet with the kernel body.</li>
<li><strong>dependencies</strong> &#8211; optional, a list of pairs of argument names
whose arrays depend on each other.
By default, only output arguments are dependent on each other.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="reikna.elementwise.specialize_elementwise">
<tt class="descclassname">reikna.elementwise.</tt><tt class="descname">specialize_elementwise</tt><big>(</big><em>outputs</em>, <em>inputs</em>, <em>scalars</em>, <em>code</em>, <em>dependencies=None</em><big>)</big><a class="headerlink" href="#reikna.elementwise.specialize_elementwise" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an Elementwise class specialized for given argument names and code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>outputs</strong> &#8211; a string or a list of strings with output argument names.</li>
<li><strong>inputs</strong> &#8211; a string or a list of strings with input argument names.</li>
<li><strong>scalars</strong> &#8211; <tt class="docutils literal"><span class="pre">None</span></tt>, a string, or a list of strings with scalar argument names.</li>
<li><strong>code</strong> &#8211; see the <tt class="docutils literal"><span class="pre">code</span></tt> argument of Elementwise&#8217;s
<a class="reference internal" href="#reikna.elementwise.Elementwise.prepare_for" title="reikna.elementwise.Elementwise.prepare_for"><tt class="xref py py-meth docutils literal"><span class="pre">prepare_for()</span></tt></a>.</li>
<li><strong>dependencies</strong> &#8211; see the <tt class="docutils literal"><span class="pre">dependencies</span></tt> argument of Elementwise&#8217;s
<a class="reference internal" href="#reikna.elementwise.Elementwise.prepare_for" title="reikna.elementwise.Elementwise.prepare_for"><tt class="xref py py-meth docutils literal"><span class="pre">prepare_for()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-reikna.matrixmul">
<span id="linear-algebra"></span><h2>Linear algebra<a class="headerlink" href="#module-reikna.matrixmul" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.matrixmul.MatrixMul">
<em class="property">class </em><tt class="descclassname">reikna.matrixmul.</tt><tt class="descname">MatrixMul</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.matrixmul.MatrixMul" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplies two matrices using last two dimensions and batching over remaining dimensions.
For batching to work, the products of remaining dimensions should be equal
(then the multiplication will be performed piecewise), or one of them should equal 1
(then the multiplication will be batched over the remaining dimensions of the other matrix).</p>
<dl class="method">
<dt id="reikna.matrixmul.MatrixMul.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>out</em>, <em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#reikna.matrixmul.MatrixMul.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>out</strong> &#8211; buffer for the result</li>
<li><strong>a</strong> &#8211; first matrix (if it is a vector, it will be reshaped to a matrix with one row)</li>
<li><strong>b</strong> &#8211; second matrix</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-reikna.transpose"></span><dl class="class">
<dt id="reikna.transpose.Transpose">
<em class="property">class </em><tt class="descclassname">reikna.transpose.</tt><tt class="descname">Transpose</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.transpose.Transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the order of axes in a multidimensional array.
Works analogous to <tt class="docutils literal"><span class="pre">numpy.transpose</span></tt>.</p>
<dl class="method">
<dt id="reikna.transpose.Transpose.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>output</em>, <em>input</em>, <em>axes=None</em><big>)</big><a class="headerlink" href="#reikna.transpose.Transpose.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; output array</li>
<li><strong>input</strong> &#8211; input array</li>
<li><strong>axes</strong> &#8211; tuple with the new axes order.
If <tt class="docutils literal"><span class="pre">None</span></tt>, then axes will be reversed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-reikna.reduce">
<span id="algorithms"></span><h2>Algorithms<a class="headerlink" href="#module-reikna.reduce" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.reduce.Reduce">
<em class="property">class </em><tt class="descclassname">reikna.reduce.</tt><tt class="descname">Reduce</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.reduce.Reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces the array over given axis using given binary operation.</p>
<dl class="method">
<dt id="reikna.reduce.Reduce.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>output</em>, <em>input</em>, <em>axis=None</em>, <em>code=SUM</em><big>)</big><a class="headerlink" href="#reikna.reduce.Reduce.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; output buffer</li>
<li><strong>input</strong> &#8211; input buffer</li>
<li><strong>axis</strong> &#8211; axis over which reduction is performed.
If <tt class="docutils literal"><span class="pre">None</span></tt>, the whole array will be reduced to a single element.</li>
<li><strong>predicate</strong> &#8211; a lambda, taking positional argument mocks and returning a snippet
which takes names of two variables to reduce and <tt class="docutils literal"><span class="pre">return</span></tt>&#8216;s the result.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="fast-fourier-transform">
<h2>Fast Fourier transform<a class="headerlink" href="#fast-fourier-transform" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.fft.FFT">
<em class="property">class </em><tt class="descclassname">reikna.fft.</tt><tt class="descname">FFT</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.fft.FFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the Fast Fourier Transform.
The interface is similar to <tt class="docutils literal"><span class="pre">numpy.fft.fftn</span></tt>.
The inverse transform is normalized so that <tt class="docutils literal"><span class="pre">IFFT(FFT(X))</span> <span class="pre">=</span> <span class="pre">X</span></tt>.</p>
<dl class="method">
<dt id="reikna.fft.FFT.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>output</em>, <em>input</em>, <em>direction</em>, <em>axes=None</em><big>)</big><a class="headerlink" href="#reikna.fft.FFT.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; output array.</li>
<li><strong>input</strong> &#8211; input array (with the same size as <tt class="docutils literal"><span class="pre">output</span></tt>).</li>
<li><strong>direction</strong> &#8211; <tt class="docutils literal"><span class="pre">-1</span></tt> for forward transform, <tt class="docutils literal"><span class="pre">1</span></tt> for inverse transform.</li>
<li><strong>axes</strong> &#8211; a tuple with axes over which to perform the transform.
If not given, the transform is performed over all the axes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Current algorithm works most effectively with array dimensions being power of 2
This mostly applies to the axes over which the transform is performed,
beacuse otherwise the computation falls back to the Bluestein&#8217;s algorithm,
which effectively halves the performance.</p>
</div>
</dd></dl>

</div>
<div class="section" id="discrete-harmonic-transform">
<h2>Discrete harmonic transform<a class="headerlink" href="#discrete-harmonic-transform" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="reikna.dht.get_spatial_grid">
<tt class="descclassname">reikna.dht.</tt><tt class="descname">get_spatial_grid</tt><big>(</big><em>modes</em>, <em>order</em>, <em>add_points=0</em><big>)</big><a class="headerlink" href="#reikna.dht.get_spatial_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spatial grid required to calculate the <tt class="docutils literal"><span class="pre">order</span></tt> power of a function
defined in the harmonic mode space of the size <tt class="docutils literal"><span class="pre">modes</span></tt>.
If <tt class="docutils literal"><span class="pre">add_points</span></tt> is 0, the grid has the minimum size required for exact
transformation back to the mode space.</p>
</dd></dl>

<dl class="function">
<dt id="reikna.dht.harmonic">
<tt class="descclassname">reikna.dht.</tt><tt class="descname">harmonic</tt><big>(</big><em>mode</em><big>)</big><a class="headerlink" href="#reikna.dht.harmonic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an eigenfunction of order <span class="math">\(n = \mathrm{mode}\)</span> for the harmonic oscillator:</p>
<div class="math">
\[\phi_{n}
= \frac{1}{\sqrt[4]{\pi} \sqrt{2^n n!}} H_n(x) \exp(-x^2/2),\]</div>
<p>where <span class="math">\(H_n\)</span> is the <span class="math">\(n\)</span>-th order &#8220;physicists&#8217;&#8221; Hermite polynomial.
The normalization is chosen so that <span class="math">\(\int \phi_n^2(x) dx = 1\)</span>.</p>
</dd></dl>

<dl class="class">
<dt id="reikna.dht.DHT">
<em class="property">class </em><tt class="descclassname">reikna.dht.</tt><tt class="descname">DHT</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.dht.DHT" title="Permalink to this definition">¶</a></dt>
<dd><p>Discrete transform to and from harmonic oscillator modes.
With <tt class="docutils literal"><span class="pre">inverse=True</span></tt> transforms a function defined by its expansion
<span class="math">\(C_m,\,m=0 \ldots M-1\)</span> in the mode space with mode functions
from <a class="reference internal" href="#reikna.dht.harmonic" title="reikna.dht.harmonic"><tt class="xref py py-func docutils literal"><span class="pre">harmonic()</span></tt></a>,
to the coordinate space (<span class="math">\(F(x)\)</span> on the grid <span class="math">\(x\)</span>
from <a class="reference internal" href="#reikna.dht.get_spatial_grid" title="reikna.dht.get_spatial_grid"><tt class="xref py py-func docutils literal"><span class="pre">get_spatial_grid()</span></tt></a>).
With <tt class="docutils literal"><span class="pre">inverse=False</span></tt> guarantees to recover first <span class="math">\(M\)</span> modes of <span class="math">\(F^k(x)\)</span>,
where <span class="math">\(k\)</span> is the <tt class="docutils literal"><span class="pre">order</span></tt> parameter.</p>
<p>For multiple dimensions the operation is the same,
and the mode functions are products of 1D mode functions, i.e.
<span class="math">\(\phi_{l,m,n}^{3D}(x,y,z) = \phi_l(x) \phi_m(y) \phi_n(z)\)</span>.</p>
<p>For the detailed description of the algorithm, see Dion &amp; Cances,
<a class="reference external" href="http://dx.doi.org/10.1103/PhysRevE.67.046706">PRE 67(4) 046706 (2003)</a></p>
<dl class="method">
<dt id="reikna.dht.DHT.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>output</em>, <em>input</em>, <em>inverse=False</em>, <em>order=1</em>, <em>axes=None</em><big>)</big><a class="headerlink" href="#reikna.dht.DHT.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; output array.
If <tt class="docutils literal"><span class="pre">inverse=False</span></tt>, its shape is used to define the mode space size.</li>
<li><strong>input</strong> &#8211; input array.
If <tt class="docutils literal"><span class="pre">inverse=True</span></tt>, its shape is used to define the mode space size.</li>
<li><strong>inverse</strong> &#8211; <tt class="docutils literal"><span class="pre">False</span></tt> for forward (coordinate space -&gt; mode space) transform,
<tt class="docutils literal"><span class="pre">True</span></tt> for inverse (mode space -&gt; coordinate space) transform.</li>
<li><strong>axes</strong> &#8211; a tuple with axes over which to perform the transform.
If not given, the transform is performed over all the axes.</li>
<li><strong>order</strong> &#8211; if <tt class="docutils literal"><span class="pre">F</span></tt> is a function in mode space, the number of spatial points
is chosen so that the transformation <tt class="docutils literal"><span class="pre">DHT[(DHT^{-1}[F])^order]</span></tt> could be performed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-reikna.cbrng">
<span id="counter-based-random-number-generators"></span><h2>Counter-based random number generators<a class="headerlink" href="#module-reikna.cbrng" title="Permalink to this headline">¶</a></h2>
<p>This module is based on the paper by Salmon et al.,
<a class="reference external" href="http://dx.doi.org/doi:10.1145/2063384.2063405">P. Int. C. High. Perform. 16 (2011)</a>.
and the source code of <a class="reference external" href="http://www.thesalmons.org/john/random123/">Random123 library</a>.</p>
<p>A counter-based random-number generator (CBRNG) is a parametrized function <span class="math">\(f_k(c)\)</span>,
where <span class="math">\(k\)</span> is the key, <span class="math">\(c\)</span> is the counter, and the function <span class="math">\(f_k\)</span> defines
a bijection in the set of integer numbers.
Being applied to successive counters, the function produces a sequence of pseudo-random numbers.
The key is an analogue of the seed of stateful RNGs;
if the CBRNG is used to generate random num bers in parallel threads, the key is a combination
of a seed and a unique thread number.</p>
<p>There are two types of generators available, <tt class="docutils literal"><span class="pre">threefry</span></tt> (uses large number of simple functions),
and <tt class="docutils literal"><span class="pre">philox</span></tt> (uses smaller number of more complicated functions).
The latter one is generally faster on GPUs; see the paper above for detailed comparisons.
These generators can be further specialized to use <tt class="docutils literal"><span class="pre">words=2</span></tt> or <tt class="docutils literal"><span class="pre">words=4</span></tt>
<tt class="docutils literal"><span class="pre">bitness=32</span></tt>-bit or <tt class="docutils literal"><span class="pre">bitness=64</span></tt>-bit counters.
Obviously, the period of the generator equals to the cardinality of the set of possible counters.
For example, if the counter consits of 4 64-bit numbers,
then the period of the generator is <span class="math">\(2^{256}\)</span>.
As for the key size, in case of <tt class="docutils literal"><span class="pre">threefry</span></tt> the key has the same size as the counter,
and for <tt class="docutils literal"><span class="pre">philox</span></tt> the key is half its size.</p>
<p>This implementation sets one of the words of the key (except for <tt class="docutils literal"><span class="pre">philox-2x64</span></tt>,
where 32 bit of the only word in the key are used), the rest are the same for all threads
and are derived from the provided <tt class="docutils literal"><span class="pre">seed</span></tt>.
This limits the maximum number of number-generating threads (<tt class="docutils literal"><span class="pre">size</span></tt>).
<tt class="docutils literal"><span class="pre">philox-2x32</span></tt> has a 32-bit key and therefore cannot be used in <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a>
(although it can be used separately as a part of larger kernel).</p>
<p>The <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a> class itself is stateless, same as other computations in Reikna,
so you have to manage the generator state yourself.
The state is created by <a class="reference internal" href="#reikna.cbrng.create_counters" title="reikna.cbrng.create_counters"><tt class="xref py py-func docutils literal"><span class="pre">create_counters()</span></tt></a>
and contains either a single counter if the target distribution uses the fixed number
of generated integers, or <tt class="docutils literal"><span class="pre">size</span></tt> counters otherwise.
This state is then passed to, and updated by a <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a> object.</p>
<p>The following values can be passed as <tt class="docutils literal"><span class="pre">distribution</span></tt> parameter:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">uniform_integer</span></tt>, parameters: <tt class="docutils literal"><span class="pre">min=0</span></tt>, <tt class="docutils literal"><span class="pre">max=2**bitness-1</span></tt>,
dtypes: <tt class="docutils literal"><span class="pre">(u)int(32/64)</span></tt>.
Generates uniformly distributed integer numbers in the interval <tt class="docutils literal"><span class="pre">[min,</span> <span class="pre">max)</span></tt>.
If the size of the interval is a power of 2, a fixed number of counters is used in each thread.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">uniform_float</span></tt>, parameters:  <tt class="docutils literal"><span class="pre">min=0</span></tt>, <tt class="docutils literal"><span class="pre">max=1</span></tt>, dtypes: <tt class="docutils literal"><span class="pre">float(32/64)</span></tt>.
Generates uniformly distributed floating-points numbers in the interval <tt class="docutils literal"><span class="pre">[min,</span> <span class="pre">max)</span></tt>.
A fixed number of counters is used in each thread.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">normal_bm</span></tt>, parameters: <tt class="docutils literal"><span class="pre">mean=0</span></tt>, <tt class="docutils literal"><span class="pre">std=1</span></tt>,  dtypes: <tt class="docutils literal"><span class="pre">float(32/64)</span></tt>.
Generates normally distributed random numbers with the mean <tt class="docutils literal"><span class="pre">mean</span></tt> and
the standard deviation <tt class="docutils literal"><span class="pre">std</span></tt> using Box-Muller transform.
A fixed number of counters is used in each thread.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">gamma</span></tt>, parameters: <tt class="docutils literal"><span class="pre">shape=1</span></tt>, <tt class="docutils literal"><span class="pre">scale=1</span></tt>,  dtypes: <tt class="docutils literal"><span class="pre">float(32/64)</span></tt>.
Generates random numbers from the gamma distribution</p>
<div class="math">
\[P(x) = x^{k-1} \frac{e^{-x/\theta}}{\theta^k \Gamma(k)},\]</div>
<p>where <span class="math">\(k\)</span> is <tt class="docutils literal"><span class="pre">shape</span></tt>, and <span class="math">\(\theta\)</span> is <tt class="docutils literal"><span class="pre">scale</span></tt>.</p>
</li>
</ul>
<dl class="function">
<dt id="reikna.cbrng.create_counters">
<tt class="descclassname">reikna.cbrng.</tt><tt class="descname">create_counters</tt><big>(</big><em>thr</em>, <em>size</em>, <em>rng</em>, <em>distribution</em>, <em>rng_params</em><big>)</big><a class="headerlink" href="#reikna.cbrng.create_counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a counter array on a device for use in <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>thr</strong> &#8211; a <a class="reference internal" href="cluda.html#reikna.cluda.api.Thread" title="reikna.cluda.api.Thread"><tt class="xref py py-class docutils literal"><span class="pre">Thread</span></tt></a> object.</li>
<li><strong>size</strong> &#8211; a shape of the target random numbers array.</li>
<li><strong>rng</strong> &#8211; random number generator name.</li>
<li><strong>distribution</strong> &#8211; random distribution name.</li>
<li><strong>rng_params</strong> &#8211; random number generator parameters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="reikna.cbrng.CBRNG">
<em class="property">class </em><tt class="descclassname">reikna.cbrng.</tt><tt class="descname">CBRNG</tt><big>(</big><em>thr</em>, <em>debug=False</em>, <em>prefix=''</em><big>)</big><a class="headerlink" href="#reikna.cbrng.CBRNG" title="Permalink to this definition">¶</a></dt>
<dd><p>Counter-based pseudo-random number generator class.</p>
<dl class="method">
<dt id="reikna.cbrng.CBRNG.prepare_for">
<tt class="descname">prepare_for</tt><big>(</big><em>new_counters</em>, <em>randoms</em>, <em>old_counters</em>, <em>seed=None</em>, <em>rng='philox'</em>, <em>rng_params=None</em>, <em>distribution='uniform_float'</em>, <em>distribution_params=None</em><big>)</big><a class="headerlink" href="#reikna.cbrng.CBRNG.prepare_for" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_counters</strong> &#8211; array of updated counters.</li>
<li><strong>randoms</strong> &#8211; array with generated random numbers.</li>
<li><strong>old_counters</strong> &#8211; array of initial counters,
generated by <a class="reference internal" href="#reikna.cbrng.create_counters" title="reikna.cbrng.create_counters"><tt class="xref py py-func docutils literal"><span class="pre">create_counters()</span></tt></a>.</li>
<li><strong>seed</strong> &#8211; <tt class="docutils literal"><span class="pre">None</span></tt> for random seed, or an integer.</li>
<li><strong>rng</strong> &#8211; <tt class="docutils literal"><span class="pre">&quot;philox&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;threefry&quot;</span></tt>.</li>
<li><strong>rng_params</strong> &#8211; a dictionary with <tt class="docutils literal"><span class="pre">bitness</span></tt> (32 or 64,
corresponds to the size of generated random integers),
<tt class="docutils literal"><span class="pre">words</span></tt> (2 or 4, number of integers generated in one go),
and <tt class="docutils literal"><span class="pre">rounds</span></tt> (the more rounds, the better randomness is achieved;
default values are big enough to qualify as PRNG).</li>
<li><strong>distribution</strong> &#8211; name of the distribution; see the list above.</li>
<li><strong>distribution_params</strong> &#8211; a dictionary with distribution-specific parameters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Computations</a><ul>
<li><a class="reference internal" href="#module-reikna.elementwise">Elementwise computations</a></li>
<li><a class="reference internal" href="#module-reikna.matrixmul">Linear algebra</a></li>
<li><a class="reference internal" href="#module-reikna.reduce">Algorithms</a></li>
<li><a class="reference internal" href="#fast-fourier-transform">Fast Fourier transform</a></li>
<li><a class="reference internal" href="#discrete-harmonic-transform">Discrete harmonic transform</a></li>
<li><a class="reference internal" href="#module-reikna.cbrng">Counter-based random number generators</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="core.html"
                        title="previous chapter">Core classes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="transformations.html"
                        title="next chapter">Transformations</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/computations.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="Transformations"
             >next</a> |</li>
        <li class="right" >
          <a href="core.html" title="Core classes"
             >previous</a> |</li>
        <li><a href="../index.html">reikna 0.2.4 documentation</a> &raquo;</li>
          <li><a href="index.html" >API reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2013, Bogdan Opanchuk.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>
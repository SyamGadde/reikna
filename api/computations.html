<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Computations &mdash; reikna 0.3.4 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="reikna 0.3.4 documentation" href="../index.html" />
    <link rel="up" title="API reference" href="index.html" />
    <link rel="next" title="Transformations" href="transformations.html" />
    <link rel="prev" title="Core functionality" href="core.html" />
 
<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34054312-1']);
    _gaq.push(['_setDomainName', 'publicfields.net']);
    _gaq.push(['_trackPageview']);

    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="Transformations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="core.html" title="Core functionality"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">reikna 0.3.4 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">API reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="computations">
<h1>Computations<a class="headerlink" href="#computations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-reikna.pureparallel">
<span id="pure-parallel-computations"></span><h2>Pure parallel computations<a class="headerlink" href="#module-reikna.pureparallel" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.pureparallel.PureParallel">
<em class="property">class </em><tt class="descclassname">reikna.pureparallel.</tt><tt class="descname">PureParallel</tt><big>(</big><em>parameters</em>, <em>code</em>, <em>guiding_array=None</em>, <em>render_kwds=None</em><big>)</big><a class="headerlink" href="#reikna.pureparallel.PureParallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>A general class for pure parallel computations
(i.e. with no interaction between threads).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parameters</strong> &#8211; a list of <a class="reference internal" href="core.html#reikna.core.Parameter" title="reikna.core.Parameter"><tt class="xref py py-class docutils literal"><span class="pre">Parameter</span></tt></a> objects.</li>
<li><strong>code</strong> &#8211; a source code for a template def.</li>
<li><strong>guiding_array</strong> &#8211; an tuple with the array shape, or the name of one of <tt class="docutils literal"><span class="pre">parameters</span></tt>.
By default, the first parameter is chosen.</li>
<li><strong>render_kwds</strong> &#8211; a dictionary with render keywords for the <tt class="docutils literal"><span class="pre">code</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="reikna.pureparallel.PureParallel.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>*args</em><big>)</big><a class="headerlink" href="#reikna.pureparallel.PureParallel.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> &#8211; corresponds to the given <tt class="docutils literal"><span class="pre">parameters</span></tt>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-reikna.matrixmul">
<span id="linear-algebra"></span><h2>Linear algebra<a class="headerlink" href="#module-reikna.matrixmul" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.matrixmul.MatrixMul">
<em class="property">class </em><tt class="descclassname">reikna.matrixmul.</tt><tt class="descname">MatrixMul</tt><big>(</big><em>a_arr</em>, <em>b_arr</em>, <em>out_arr=None</em>, <em>block_width_override=None</em><big>)</big><a class="headerlink" href="#reikna.matrixmul.MatrixMul" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>Multiplies two matrices using last two dimensions and batching over remaining dimensions.
For batching to work, the products of remaining dimensions should be equal
(then the multiplication will be performed piecewise), or one of them should equal 1
(then the multiplication will be batched over the remaining dimensions of the other matrix).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>a_arr</strong> &#8211; an array-like defining the first argument.</li>
<li><strong>b_arr</strong> &#8211; an array-like defining the second argument.</li>
<li><strong>out_arr</strong> &#8211; an array-like definign the output; if not given, both shape and dtype
will be derived from <tt class="docutils literal"><span class="pre">a_arr</span></tt> and <tt class="docutils literal"><span class="pre">b_arr</span></tt>.</li>
<li><strong>block_width_override</strong> &#8211; if provided, it will used as a block size of
the multiplication kernel.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="reikna.matrixmul.MatrixMul.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>output:o</em>, <em>matrix_a:i</em>, <em>matrix_b:i</em><big>)</big><a class="headerlink" href="#reikna.matrixmul.MatrixMul.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; the output of matrix multiplication.</li>
<li><strong>matrix_a</strong> &#8211; the first argument.</li>
<li><strong>matrix_b</strong> &#8211; the second argument.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-reikna.transpose"></span><dl class="class">
<dt id="reikna.transpose.Transpose">
<em class="property">class </em><tt class="descclassname">reikna.transpose.</tt><tt class="descname">Transpose</tt><big>(</big><em>arr_t</em>, <em>axes=None</em>, <em>block_width_override=None</em><big>)</big><a class="headerlink" href="#reikna.transpose.Transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>Changes the order of axes in a multidimensional array.
Works analogous to <tt class="docutils literal"><span class="pre">numpy.transpose</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr_t</strong> &#8211; an array-like defining the initial array.</li>
<li><strong>axes</strong> &#8211; tuple with the new axes order.
If <tt class="docutils literal"><span class="pre">None</span></tt>, then axes will be reversed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="reikna.transpose.Transpose.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>output:o</em>, <em>input:i</em><big>)</big><a class="headerlink" href="#reikna.transpose.Transpose.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; an array with all the attributes of <tt class="docutils literal"><span class="pre">arr_t</span></tt>,
with the shape permuted according to <tt class="docutils literal"><span class="pre">axes</span></tt>.</li>
<li><strong>input</strong> &#8211; an array with all the attributes of <tt class="docutils literal"><span class="pre">arr_t</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-reikna.reduce">
<span id="algorithms"></span><h2>Algorithms<a class="headerlink" href="#module-reikna.reduce" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.reduce.Predicate">
<em class="property">class </em><tt class="descclassname">reikna.reduce.</tt><tt class="descname">Predicate</tt><big>(</big><em>operation</em>, <em>empty</em><big>)</big><a class="headerlink" href="#reikna.reduce.Predicate" title="Permalink to this definition">¶</a></dt>
<dd><p>A predicate used in <a class="reference internal" href="#reikna.reduce.Reduce" title="reikna.reduce.Reduce"><tt class="xref py py-class docutils literal"><span class="pre">Reduce</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>operation</strong> &#8211; a <a class="reference internal" href="cluda.html#reikna.cluda.Snippet" title="reikna.cluda.Snippet"><tt class="xref py py-class docutils literal"><span class="pre">Snippet</span></tt></a> object with two parameters
which will take the names of two arguments to join.</li>
<li><strong>empty</strong> &#8211; a string with the empty value of the argument
(the one which, being joined by another argument, does not change it).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="reikna.reduce.Reduce">
<em class="property">class </em><tt class="descclassname">reikna.reduce.</tt><tt class="descname">Reduce</tt><big>(</big><em>arr_t</em>, <em>predicate</em>, <em>axes=None</em><big>)</big><a class="headerlink" href="#reikna.reduce.Reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>Reduces the array over given axis using given binary operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr_t</strong> &#8211; an array-like defining the initial array.</li>
<li><strong>predicate</strong> &#8211; a <a class="reference internal" href="#reikna.reduce.Predicate" title="reikna.reduce.Predicate"><tt class="xref py py-class docutils literal"><span class="pre">Predicate</span></tt></a> object.</li>
<li><strong>axes</strong> &#8211; a list of sequential axes to reduce over.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="reikna.reduce.Reduce.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>output:o</em>, <em>input:i</em><big>)</big><a class="headerlink" href="#reikna.reduce.Reduce.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input</strong> &#8211; an array with the attributes of <tt class="docutils literal"><span class="pre">arr_t</span></tt>.</li>
<li><strong>output</strong> &#8211; an array with the attributes of <tt class="docutils literal"><span class="pre">arr_t</span></tt>,
with its shape missing axes from <tt class="docutils literal"><span class="pre">axes</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="reikna.reduce.predicate_sum">
<tt class="descclassname">reikna.reduce.</tt><tt class="descname">predicate_sum</tt><big>(</big><em>dtype</em><big>)</big><a class="headerlink" href="#reikna.reduce.predicate_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#reikna.reduce.Predicate" title="reikna.reduce.Predicate"><tt class="xref py py-class docutils literal"><span class="pre">Predicate</span></tt></a> object which sums its arguments.</p>
</dd></dl>

</div>
<div class="section" id="fast-fourier-transform">
<h2>Fast Fourier transform<a class="headerlink" href="#fast-fourier-transform" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="reikna.fft.FFT">
<em class="property">class </em><tt class="descclassname">reikna.fft.</tt><tt class="descname">FFT</tt><big>(</big><em>arr_t</em>, <em>axes=None</em><big>)</big><a class="headerlink" href="#reikna.fft.FFT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>Performs the Fast Fourier Transform.
The interface is similar to <tt class="docutils literal"><span class="pre">numpy.fft.fftn</span></tt>.
The inverse transform is normalized so that <tt class="docutils literal"><span class="pre">IFFT(FFT(X))</span> <span class="pre">=</span> <span class="pre">X</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr_t</strong> &#8211; an array-like defining the problem array.</li>
<li><strong>axes</strong> &#8211; a tuple with axes over which to perform the transform.
If not given, the transform is performed over all the axes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Current algorithm works most effectively with array dimensions being power of 2
This mostly applies to the axes over which the transform is performed,
beacuse otherwise the computation falls back to the Bluestein&#8217;s algorithm,
which effectively halves the performance.</p>
</div>
<dl class="method">
<dt id="reikna.fft.FFT.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>output:o</em>, <em>input:i</em>, <em>inverse:s</em><big>)</big><a class="headerlink" href="#reikna.fft.FFT.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>output</strong> &#8211; an array wit the attributes of <tt class="docutils literal"><span class="pre">arr_t</span></tt>.</li>
<li><strong>input</strong> &#8211; an array wit the attributes of <tt class="docutils literal"><span class="pre">arr_t</span></tt>.</li>
<li><strong>inverse</strong> &#8211; a scalar value castable to integer.
If <tt class="docutils literal"><span class="pre">1</span></tt>, <tt class="docutils literal"><span class="pre">output</span></tt> contains the forward FFT of <tt class="docutils literal"><span class="pre">input</span></tt>,
if <tt class="docutils literal"><span class="pre">0</span></tt> the inverse one.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="discrete-harmonic-transform">
<h2>Discrete harmonic transform<a class="headerlink" href="#discrete-harmonic-transform" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="reikna.dht.get_spatial_grid">
<tt class="descclassname">reikna.dht.</tt><tt class="descname">get_spatial_grid</tt><big>(</big><em>modes</em>, <em>order</em>, <em>add_points=0</em><big>)</big><a class="headerlink" href="#reikna.dht.get_spatial_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spatial grid required to calculate the <tt class="docutils literal"><span class="pre">order</span></tt> power of a function
defined in the harmonic mode space of the size <tt class="docutils literal"><span class="pre">modes</span></tt>.
If <tt class="docutils literal"><span class="pre">add_points</span></tt> is 0, the grid has the minimum size required for exact
transformation back to the mode space.</p>
</dd></dl>

<dl class="function">
<dt id="reikna.dht.harmonic">
<tt class="descclassname">reikna.dht.</tt><tt class="descname">harmonic</tt><big>(</big><em>mode</em><big>)</big><a class="headerlink" href="#reikna.dht.harmonic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an eigenfunction of order <span class="math">\(n = \mathrm{mode}\)</span> for the harmonic oscillator:</p>
<div class="math">
\[\phi_{n}
= \frac{1}{\sqrt[4]{\pi} \sqrt{2^n n!}} H_n(x) \exp(-x^2/2),\]</div>
<p>where <span class="math">\(H_n\)</span> is the <span class="math">\(n\)</span>-th order &#8220;physicists&#8217;&#8221; Hermite polynomial.
The normalization is chosen so that <span class="math">\(\int \phi_n^2(x) dx = 1\)</span>.</p>
</dd></dl>

<dl class="class">
<dt id="reikna.dht.DHT">
<em class="property">class </em><tt class="descclassname">reikna.dht.</tt><tt class="descname">DHT</tt><big>(</big><em>mode_arr</em>, <em>add_points=None</em>, <em>inverse=False</em>, <em>order=1</em>, <em>axes=None</em><big>)</big><a class="headerlink" href="#reikna.dht.DHT" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>Discrete transform to and from harmonic oscillator modes.
With <tt class="docutils literal"><span class="pre">inverse=True</span></tt> transforms a function defined by its expansion
<span class="math">\(C_m,\,m=0 \ldots M-1\)</span> in the mode space with mode functions
from <a class="reference internal" href="#reikna.dht.harmonic" title="reikna.dht.harmonic"><tt class="xref py py-func docutils literal"><span class="pre">harmonic()</span></tt></a>,
to the coordinate space (<span class="math">\(F(x)\)</span> on the grid <span class="math">\(x\)</span>
from <a class="reference internal" href="#reikna.dht.get_spatial_grid" title="reikna.dht.get_spatial_grid"><tt class="xref py py-func docutils literal"><span class="pre">get_spatial_grid()</span></tt></a>).
With <tt class="docutils literal"><span class="pre">inverse=False</span></tt> guarantees to recover first <span class="math">\(M\)</span> modes of <span class="math">\(F^k(x)\)</span>,
where <span class="math">\(k\)</span> is the <tt class="docutils literal"><span class="pre">order</span></tt> parameter.</p>
<p>For multiple dimensions the operation is the same,
and the mode functions are products of 1D mode functions, i.e.
<span class="math">\(\phi_{l,m,n}^{3D}(x,y,z) = \phi_l(x) \phi_m(y) \phi_n(z)\)</span>.</p>
<p>For the detailed description of the algorithm, see Dion &amp; Cances,
<a class="reference external" href="http://dx.doi.org/10.1103/PhysRevE.67.046706">PRE 67(4) 046706 (2003)</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mode_arr</strong> &#8211; an array-like object defining the shape of mode space.
If <tt class="docutils literal"><span class="pre">inverse=False</span></tt>, its shape is used to define the mode space size.</li>
<li><strong>inverse</strong> &#8211; <tt class="docutils literal"><span class="pre">False</span></tt> for forward (coordinate space -&gt; mode space) transform,
<tt class="docutils literal"><span class="pre">True</span></tt> for inverse (mode space -&gt; coordinate space) transform.</li>
<li><strong>axes</strong> &#8211; a tuple with axes over which to perform the transform.
If not given, the transform is performed over all the axes.</li>
<li><strong>order</strong> &#8211; if <tt class="docutils literal"><span class="pre">F</span></tt> is a function in mode space, the number of spatial points
is chosen so that the transformation <tt class="docutils literal"><span class="pre">DHT[(DHT^{-1}[F])^order]</span></tt> could be performed.</li>
<li><strong>add_points</strong> &#8211; a list of the same length as <tt class="docutils literal"><span class="pre">mode_arr</span></tt> shape,
specifying the number of points in x-space to use in addition to minimally required
(<tt class="docutils literal"><span class="pre">0</span></tt> by default).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="reikna.dht.DHT.compiled_signature_forward">
<tt class="descname">compiled_signature_forward</tt><big>(</big><em>modes:o</em>, <em>coords:i</em><big>)</big><a class="headerlink" href="#reikna.dht.DHT.compiled_signature_forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="reikna.dht.DHT.compiled_signature_inverse">
<tt class="descname">compiled_signature_inverse</tt><big>(</big><em>coords:o</em>, <em>modes:i</em><big>)</big><a class="headerlink" href="#reikna.dht.DHT.compiled_signature_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Depending on <tt class="docutils literal"><span class="pre">inverse</span></tt> value, either of these two will be created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>modes</strong> &#8211; an array with the attributes of <tt class="docutils literal"><span class="pre">mode_arr</span></tt>.</li>
<li><strong>coords</strong> &#8211; an array with the shape depending on <tt class="docutils literal"><span class="pre">mode_arr</span></tt>, <tt class="docutils literal"><span class="pre">axes</span></tt>, <tt class="docutils literal"><span class="pre">order</span></tt>
and <tt class="docutils literal"><span class="pre">add_points</span></tt>, and the dtype of <tt class="docutils literal"><span class="pre">mode_arr</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-reikna.cbrng">
<span id="counter-based-random-number-generators"></span><h2>Counter-based random number generators<a class="headerlink" href="#module-reikna.cbrng" title="Permalink to this headline">¶</a></h2>
<p>This module is based on the paper by Salmon et al.,
<a class="reference external" href="http://dx.doi.org/doi:10.1145/2063384.2063405">P. Int. C. High. Perform. 16 (2011)</a>.
and the source code of <a class="reference external" href="http://www.thesalmons.org/john/random123/">Random123 library</a>.</p>
<p>A counter-based random-number generator (CBRNG) is a parametrized function <span class="math">\(f_k(c)\)</span>,
where <span class="math">\(k\)</span> is the key, <span class="math">\(c\)</span> is the counter, and the function <span class="math">\(f_k\)</span> defines
a bijection in the set of integer numbers.
Being applied to successive counters, the function produces a sequence of pseudo-random numbers.
The key is an analogue of the seed of stateful RNGs;
if the CBRNG is used to generate random num bers in parallel threads, the key is a combination
of a seed and a unique thread number.</p>
<p>There are two types of generators available, <tt class="docutils literal"><span class="pre">threefry</span></tt> (uses large number of simple functions),
and <tt class="docutils literal"><span class="pre">philox</span></tt> (uses smaller number of more complicated functions).
The latter one is generally faster on GPUs; see the paper above for detailed comparisons.
These generators can be further specialized to use <tt class="docutils literal"><span class="pre">words=2</span></tt> or <tt class="docutils literal"><span class="pre">words=4</span></tt>
<tt class="docutils literal"><span class="pre">bitness=32</span></tt>-bit or <tt class="docutils literal"><span class="pre">bitness=64</span></tt>-bit counters.
Obviously, the period of the generator equals to the cardinality of the set of possible counters.
For example, if the counter consits of 4 64-bit numbers,
then the period of the generator is <span class="math">\(2^{256}\)</span>.
As for the key size, in case of <tt class="docutils literal"><span class="pre">threefry</span></tt> the key has the same size as the counter,
and for <tt class="docutils literal"><span class="pre">philox</span></tt> the key is half its size.</p>
<p>The <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a> class sets one of the words of the key
(except for <tt class="docutils literal"><span class="pre">philox-2x64</span></tt>, where 32 bit of the only word in the key are used),
the rest are the same for all threads and are derived from the provided <tt class="docutils literal"><span class="pre">seed</span></tt>.
This limits the maximum number of number-generating threads (<tt class="docutils literal"><span class="pre">size</span></tt>).
<tt class="docutils literal"><span class="pre">philox-2x32</span></tt> has a 32-bit key and therefore cannot be used in <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a>
(although it can be used separately with the help of the kernel API).</p>
<p>The <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a> class itself is stateless, same as other computations in Reikna,
so you have to manage the generator state yourself.
The state is created by the <a class="reference internal" href="#reikna.cbrng.CBRNG.create_counters" title="reikna.cbrng.CBRNG.create_counters"><tt class="xref py py-meth docutils literal"><span class="pre">create_counters()</span></tt></a> method
and contains a <tt class="docutils literal"><span class="pre">size</span></tt> counters.
This state is then passed to, and updated by a <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a> object.</p>
<dl class="class">
<dt id="reikna.cbrng.CBRNG">
<em class="property">class </em><tt class="descclassname">reikna.cbrng.</tt><tt class="descname">CBRNG</tt><big>(</big><em>randoms_arr</em>, <em>generators_dim</em>, <em>sampler</em>, <em>seed=None</em><big>)</big><a class="headerlink" href="#reikna.cbrng.CBRNG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core.html#reikna.core.Computation" title="reikna.core.Computation"><tt class="xref py py-class docutils literal"><span class="pre">Computation</span></tt></a></p>
<p>Counter-based pseudo-random number generator class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>randoms_arr</strong> &#8211; an array intended for storing generated random numbers.</li>
<li><strong>generators_dim</strong> &#8211; the number of dimensions (counting from the end)
which will use independent generators.
For example, if <tt class="docutils literal"><span class="pre">randoms_arr</span></tt> has the shape <tt class="docutils literal"><span class="pre">(100,</span> <span class="pre">200,</span> <span class="pre">300)</span></tt> and
<tt class="docutils literal"><span class="pre">generators_dim</span></tt> is <tt class="docutils literal"><span class="pre">2</span></tt>, then every sub-array <tt class="docutils literal"><span class="pre">(100,</span> <span class="pre">:,</span> <span class="pre">:)</span></tt>
will use an independent generator.</li>
<li><strong>sampler</strong> &#8211; a <a class="reference internal" href="#reikna.cbrng.samplers.Sampler" title="reikna.cbrng.samplers.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object.</li>
<li><strong>seed</strong> &#8211; <tt class="docutils literal"><span class="pre">None</span></tt> for random seed, or an integer.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="classmethod">
<dt id="reikna.cbrng.CBRNG.sampler_name">
<em class="property">classmethod </em><tt class="descname">sampler_name</tt><big>(</big><em>randoms_arr</em>, <em>generators_dim</em>, <em>sampler_kwds=None</em>, <em>seed=None</em><big>)</big><a class="headerlink" href="#reikna.cbrng.CBRNG.sampler_name" title="Permalink to this definition">¶</a></dt>
<dd><p>A convenience constructor for the sampler <tt class="docutils literal"><span class="pre">sampler_name</span></tt>
from <a class="reference internal" href="#module-reikna.cbrng.samplers" title="reikna.cbrng.samplers"><tt class="xref py py-mod docutils literal"><span class="pre">samplers</span></tt></a>.
The contents of the dictionary <tt class="docutils literal"><span class="pre">sampler_kwds</span></tt> will be passed to the sampler constructor
function (with <tt class="docutils literal"><span class="pre">bijection</span></tt> being created automatically,
and <tt class="docutils literal"><span class="pre">dtype</span></tt> taken from <tt class="docutils literal"><span class="pre">randoms_arr</span></tt>).</p>
</dd></dl>

<dl class="method">
<dt id="reikna.cbrng.CBRNG.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>counters:io</em>, <em>randoms:o</em><big>)</big><a class="headerlink" href="#reikna.cbrng.CBRNG.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>counters</strong> &#8211; the RNG &#8220;state&#8221;.
All attributes are equal to the ones of the result of <a class="reference internal" href="#reikna.cbrng.CBRNG.create_counters" title="reikna.cbrng.CBRNG.create_counters"><tt class="xref py py-meth docutils literal"><span class="pre">create_counters()</span></tt></a>.</li>
<li><strong>randoms</strong> &#8211; generated random numbers.
All attributes are equal to the ones of <tt class="docutils literal"><span class="pre">randoms_arr</span></tt> from the constructor.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="reikna.cbrng.CBRNG.create_counters">
<tt class="descname">create_counters</tt><big>(</big><big>)</big><a class="headerlink" href="#reikna.cbrng.CBRNG.create_counters" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a counter array for use in <a class="reference internal" href="#reikna.cbrng.CBRNG" title="reikna.cbrng.CBRNG"><tt class="xref py py-class docutils literal"><span class="pre">CBRNG</span></tt></a>.</p>
</dd></dl>

</dd></dl>

<div class="section" id="module-reikna.cbrng.bijections">
<span id="kernel-api"></span><h3>Kernel API<a class="headerlink" href="#module-reikna.cbrng.bijections" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="reikna.cbrng.bijections.Bijection">
<em class="property">class </em><tt class="descclassname">reikna.cbrng.bijections.</tt><tt class="descname">Bijection</tt><a class="headerlink" href="#reikna.cbrng.bijections.Bijection" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a CBRNG bijection module and accompanying metadata.
Supports <tt class="docutils literal"><span class="pre">__process_modules__</span></tt> protocol.</p>
<dl class="attribute">
<dt id="reikna.cbrng.bijections.Bijection.dtype">
<tt class="descname">dtype</tt><a class="headerlink" href="#reikna.cbrng.bijections.Bijection.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The data type of the integer word used by the generator.</p>
</dd></dl>

<dl class="attribute">
<dt id="reikna.cbrng.bijections.Bijection.counter_words">
<tt class="descname">counter_words</tt><a class="headerlink" href="#reikna.cbrng.bijections.Bijection.counter_words" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of words used by the counter.</p>
</dd></dl>

<dl class="attribute">
<dt id="reikna.cbrng.bijections.Bijection.key_words">
<tt class="descname">key_words</tt><a class="headerlink" href="#reikna.cbrng.bijections.Bijection.key_words" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of words used by the key.</p>
</dd></dl>

<dl class="attribute">
<dt id="reikna.cbrng.bijections.Bijection.module">
<tt class="descname">module</tt><a class="headerlink" href="#reikna.cbrng.bijections.Bijection.module" title="Permalink to this definition">¶</a></dt>
<dd><p>The module containing the CBRNG function.
It provides the C functions below.</p>
</dd></dl>

<dl class="macro">
<dt id="COUNTER_WORDS">
<tt class="descname">COUNTER_WORDS</tt><a class="headerlink" href="#COUNTER_WORDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the value of <a class="reference internal" href="#reikna.cbrng.bijections.Bijection.counter_words" title="reikna.cbrng.bijections.Bijection.counter_words"><tt class="xref py py-attr docutils literal"><span class="pre">counter_words</span></tt></a>.</p>
</dd></dl>

<dl class="macro">
<dt id="KEY_WORDS">
<tt class="descname">KEY_WORDS</tt><a class="headerlink" href="#KEY_WORDS" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the value of <a class="reference internal" href="#reikna.cbrng.bijections.Bijection.key_words" title="reikna.cbrng.bijections.Bijection.key_words"><tt class="xref py py-attr docutils literal"><span class="pre">key_words</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="word">
<tt class="descname">word</tt><a class="headerlink" href="#word" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the type corresponding to <a class="reference internal" href="#reikna.cbrng.bijections.Bijection.dtype" title="reikna.cbrng.bijections.Bijection.dtype"><tt class="xref py py-attr docutils literal"><span class="pre">dtype</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="COUNTER">
<tt class="descname">COUNTER</tt><a class="headerlink" href="#COUNTER" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the bijection counter, or its output.</p>
<dl class="member">
<dt>
<tt class="descname">word v[COUNTER_WORDS]</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="type">
<dt id="KEY">
<tt class="descname">KEY</tt><a class="headerlink" href="#KEY" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the bijection key.</p>
<dl class="member">
<dt>
<tt class="descname">word v[KEY_WORDS]</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="make_counter_from_int">
<a class="reference internal" href="#COUNTER" title="COUNTER">COUNTER</a> <tt class="descname">make_counter_from_int</tt><big>(</big>int<em>&nbsp;x</em><big>)</big><a class="headerlink" href="#make_counter_from_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a counter object from an integer.</p>
</dd></dl>

<dl class="function">
<dt id="bijection">
<a class="reference internal" href="#COUNTER" title="COUNTER">COUNTER</a> <tt class="descname">bijection</tt><big>(</big><a class="reference internal" href="#KEY" title="KEY">KEY</a><em>&nbsp;key</em>, <a class="reference internal" href="#COUNTER" title="COUNTER">COUNTER</a><em>&nbsp;counter</em><big>)</big><a class="headerlink" href="#bijection" title="Permalink to this definition">¶</a></dt>
<dd><p>The main bijection function.</p>
</dd></dl>

<dl class="type">
<dt id="STATE">
<tt class="descname">STATE</tt><a class="headerlink" href="#STATE" title="Permalink to this definition">¶</a></dt>
<dd><p>A structure containing the CBRNG state which is used by <a class="reference internal" href="#module-reikna.cbrng.samplers" title="reikna.cbrng.samplers"><tt class="xref py py-mod docutils literal"><span class="pre">samplers</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="uint32">
<tt class="descname">uint32</tt><a class="headerlink" href="#uint32" title="Permalink to this definition">¶</a></dt>
<dd><p>A type of unigned 32-bit word.</p>
</dd></dl>

<dl class="type">
<dt id="uint64">
<tt class="descname">uint64</tt><a class="headerlink" href="#uint64" title="Permalink to this definition">¶</a></dt>
<dd><p>A type of unigned 64-bit word.</p>
</dd></dl>

<dl class="function">
<dt id="make_state">
<a class="reference internal" href="#STATE" title="STATE">STATE</a> <tt class="descname">make_state</tt><big>(</big><a class="reference internal" href="#KEY" title="KEY">KEY</a><em>&nbsp;key</em>, <a class="reference internal" href="#COUNTER" title="COUNTER">COUNTER</a><em>&nbsp;counter</em><big>)</big><a class="headerlink" href="#make_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new state object.</p>
</dd></dl>

<dl class="function">
<dt id="get_next_unused_counter">
<a class="reference internal" href="#COUNTER" title="COUNTER">COUNTER</a> <tt class="descname">get_next_unused_counter</tt><big>(</big><a class="reference internal" href="#STATE" title="STATE">STATE</a><em>&nbsp;state</em><big>)</big><a class="headerlink" href="#get_next_unused_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a counter which has not been used in random sampling.</p>
</dd></dl>

<dl class="function">
<dt id="get_raw_uint32">
<a class="reference internal" href="#uint32" title="uint32">uint32</a> <tt class="descname">get_raw_uint32</tt><big>(</big><a class="reference internal" href="#STATE" title="STATE">STATE</a><em>&nbsp;*state</em><big>)</big><a class="headerlink" href="#get_raw_uint32" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns uniformly distributed unsigned 32-bit word and updates the state.</p>
</dd></dl>

<dl class="function">
<dt id="get_raw_uint64">
<a class="reference internal" href="#uint64" title="uint64">uint64</a> <tt class="descname">get_raw_uint64</tt><big>(</big><a class="reference internal" href="#STATE" title="STATE">STATE</a><em>&nbsp;*state</em><big>)</big><a class="headerlink" href="#get_raw_uint64" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns uniformly distributed unsigned 64-bit word and updates the state.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="reikna.cbrng.bijections.philox">
<tt class="descclassname">reikna.cbrng.bijections.</tt><tt class="descname">philox</tt><big>(</big><em>bitness</em>, <em>counter_words</em>, <em>rounds=10</em><big>)</big><a class="headerlink" href="#reikna.cbrng.bijections.philox" title="Permalink to this definition">¶</a></dt>
<dd><p>A CBRNG based on a low number of slow rounds (multiplications).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bitness</strong> &#8211; <tt class="docutils literal"><span class="pre">32</span></tt> or <tt class="docutils literal"><span class="pre">64</span></tt>, corresponds to the size of generated random integers.</li>
<li><strong>counter_words</strong> &#8211; <tt class="docutils literal"><span class="pre">2</span></tt> or <tt class="docutils literal"><span class="pre">4</span></tt>, number of integers generated in one go.</li>
<li><strong>rounds</strong> &#8211; <tt class="docutils literal"><span class="pre">1</span></tt> to <tt class="docutils literal"><span class="pre">12</span></tt>, the more rounds, the better randomness is achieved.
Default values are big enough to qualify as PRNG.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#reikna.cbrng.bijections.Bijection" title="reikna.cbrng.bijections.Bijection"><tt class="xref py py-class docutils literal"><span class="pre">Bijection</span></tt></a> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="reikna.cbrng.bijections.threefry">
<tt class="descclassname">reikna.cbrng.bijections.</tt><tt class="descname">threefry</tt><big>(</big><em>bitness</em>, <em>counter_words</em>, <em>rounds=20</em><big>)</big><a class="headerlink" href="#reikna.cbrng.bijections.threefry" title="Permalink to this definition">¶</a></dt>
<dd><p>A CBRNG based on a big number of fast rounds (bit rotations).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>bitness</strong> &#8211; <tt class="docutils literal"><span class="pre">32</span></tt> or <tt class="docutils literal"><span class="pre">64</span></tt>, corresponds to the size of generated random integers.</li>
<li><strong>counter_words</strong> &#8211; <tt class="docutils literal"><span class="pre">2</span></tt> or <tt class="docutils literal"><span class="pre">4</span></tt>, number of integers generated in one go.</li>
<li><strong>rounds</strong> &#8211; <tt class="docutils literal"><span class="pre">1</span></tt> to <tt class="docutils literal"><span class="pre">72</span></tt>, the more rounds, the better randomness is achieved.
Default values are big enough to qualify as PRNG.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a <a class="reference internal" href="#reikna.cbrng.bijections.Bijection" title="reikna.cbrng.bijections.Bijection"><tt class="xref py py-class docutils literal"><span class="pre">Bijection</span></tt></a> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-reikna.cbrng.samplers"></span><dl class="class">
<dt id="reikna.cbrng.samplers.Sampler">
<em class="property">class </em><tt class="descclassname">reikna.cbrng.samplers.</tt><tt class="descname">Sampler</tt><a class="headerlink" href="#reikna.cbrng.samplers.Sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a random distribution sampler module and accompanying metadata.
Supports <tt class="docutils literal"><span class="pre">__process_modules__</span></tt> protocol.</p>
<dl class="attribute">
<dt id="reikna.cbrng.samplers.Sampler.deterministic">
<tt class="descname">deterministic</tt><a class="headerlink" href="#reikna.cbrng.samplers.Sampler.deterministic" title="Permalink to this definition">¶</a></dt>
<dd><p>If <tt class="docutils literal"><span class="pre">True</span></tt>, every sampled random number consumes the same amount of counters.</p>
</dd></dl>

<dl class="attribute">
<dt id="reikna.cbrng.samplers.Sampler.randoms_per_call">
<tt class="descname">randoms_per_call</tt><a class="headerlink" href="#reikna.cbrng.samplers.Sampler.randoms_per_call" title="Permalink to this definition">¶</a></dt>
<dd><p>How many random numbers one call to <tt class="docutils literal"><span class="pre">sample</span></tt> creates.</p>
</dd></dl>

<dl class="attribute">
<dt id="reikna.cbrng.samplers.Sampler.dtype">
<tt class="descname">dtype</tt><a class="headerlink" href="#reikna.cbrng.samplers.Sampler.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The data type of one random value produced by the sampler.</p>
</dd></dl>

<dl class="attribute">
<dt id="reikna.cbrng.samplers.Sampler.module">
<tt class="descname">module</tt><a class="headerlink" href="#reikna.cbrng.samplers.Sampler.module" title="Permalink to this definition">¶</a></dt>
<dd><p>The module containing the distribution sampling function.
It provides the C functions below.</p>
</dd></dl>

<dl class="macro">
<dt id="RANDOMS_PER_CALL">
<tt class="descname">RANDOMS_PER_CALL</tt><a class="headerlink" href="#RANDOMS_PER_CALL" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the value of <a class="reference internal" href="#reikna.cbrng.samplers.Sampler.randoms_per_call" title="reikna.cbrng.samplers.Sampler.randoms_per_call"><tt class="xref py py-attr docutils literal"><span class="pre">randoms_per_call</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="value">
<tt class="descname">value</tt><a class="headerlink" href="#value" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the type corresponding to <a class="reference internal" href="#reikna.cbrng.samplers.Sampler.dtype" title="reikna.cbrng.samplers.Sampler.dtype"><tt class="xref py py-attr docutils literal"><span class="pre">dtype</span></tt></a>.</p>
</dd></dl>

<dl class="type">
<dt id="RESULT">
<tt class="descname">RESULT</tt><a class="headerlink" href="#RESULT" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the sampling result.</p>
<dl class="member">
<dt>
<tt class="descname">value v[RANDOMS_PER_CALL]</tt></dt>
<dd></dd></dl>

</dd></dl>

<dl class="type">
<dt id="sample">
<a class="reference internal" href="#RESULT" title="RESULT">RESULT</a> <tt class="descname">sample</tt><big>(</big><a class="reference internal" href="#STATE" title="STATE">STATE</a><em>&nbsp;*state</em><big>)</big><a class="headerlink" href="#sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the sampling, updating the state.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="reikna.cbrng.samplers.gamma">
<tt class="descclassname">reikna.cbrng.samplers.</tt><tt class="descname">gamma</tt><big>(</big><em>bijection</em>, <em>dtype</em>, <em>shape=1</em>, <em>scale=1</em><big>)</big><a class="headerlink" href="#reikna.cbrng.samplers.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates random numbers from the gamma distribution</p>
<div class="math">
\[P(x) = x^{k-1} \frac{e^{-x/\theta}}{\theta^k \Gamma(k)},\]</div>
<p>where <span class="math">\(k\)</span> is <tt class="docutils literal"><span class="pre">shape</span></tt>, and <span class="math">\(\theta\)</span> is <tt class="docutils literal"><span class="pre">scale</span></tt>.
Supported dtypes: <tt class="docutils literal"><span class="pre">float(32/64)</span></tt>.
Returns a <a class="reference internal" href="#reikna.cbrng.samplers.Sampler" title="reikna.cbrng.samplers.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object.</p>
</dd></dl>

<dl class="function">
<dt id="reikna.cbrng.samplers.normal_bm">
<tt class="descclassname">reikna.cbrng.samplers.</tt><tt class="descname">normal_bm</tt><big>(</big><em>bijection</em>, <em>dtype</em>, <em>mean=0</em>, <em>std=1</em><big>)</big><a class="headerlink" href="#reikna.cbrng.samplers.normal_bm" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates normally distributed random numbers with the mean <tt class="docutils literal"><span class="pre">mean</span></tt> and
the standard deviation <tt class="docutils literal"><span class="pre">std</span></tt> using Box-Muller transform.
Supported dtypes: <tt class="docutils literal"><span class="pre">float(32/64)</span></tt>.
Produces two random numbers per call.
Returns a <a class="reference internal" href="#reikna.cbrng.samplers.Sampler" title="reikna.cbrng.samplers.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object.</p>
</dd></dl>

<dl class="function">
<dt id="reikna.cbrng.samplers.uniform_float">
<tt class="descclassname">reikna.cbrng.samplers.</tt><tt class="descname">uniform_float</tt><big>(</big><em>bijection</em>, <em>dtype</em>, <em>low=0</em>, <em>high=1</em><big>)</big><a class="headerlink" href="#reikna.cbrng.samplers.uniform_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates uniformly distributed floating-points numbers in the interval <tt class="docutils literal"><span class="pre">[low,</span> <span class="pre">high)</span></tt>.
Supported dtypes: <tt class="docutils literal"><span class="pre">float(32/64)</span></tt>.
A fixed number of counters is used in each thread.
Returns a <a class="reference internal" href="#reikna.cbrng.samplers.Sampler" title="reikna.cbrng.samplers.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object.</p>
</dd></dl>

<dl class="function">
<dt id="reikna.cbrng.samplers.uniform_integer">
<tt class="descclassname">reikna.cbrng.samplers.</tt><tt class="descname">uniform_integer</tt><big>(</big><em>bijection</em>, <em>dtype</em>, <em>low</em>, <em>high=None</em><big>)</big><a class="headerlink" href="#reikna.cbrng.samplers.uniform_integer" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates uniformly distributed integer numbers in the interval <tt class="docutils literal"><span class="pre">[low,</span> <span class="pre">high)</span></tt>.
If <tt class="docutils literal"><span class="pre">high</span></tt> is <tt class="docutils literal"><span class="pre">None</span></tt>, the interval is <tt class="docutils literal"><span class="pre">[0,</span> <span class="pre">low)</span></tt>.
Supported dtypes: any numpy integers.
If the size of the interval is a power of 2, a fixed number of counters
is used in each thread.
Returns a <a class="reference internal" href="#reikna.cbrng.samplers.Sampler" title="reikna.cbrng.samplers.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object.</p>
</dd></dl>

<span class="target" id="module-reikna.cbrng.tools"></span><dl class="class">
<dt id="reikna.cbrng.tools.KeyGenerator">
<em class="property">class </em><tt class="descclassname">reikna.cbrng.tools.</tt><tt class="descname">KeyGenerator</tt><a class="headerlink" href="#reikna.cbrng.tools.KeyGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains a key generator module and accompanying metadata.
Supports <tt class="docutils literal"><span class="pre">__process_modules__</span></tt> protocol.</p>
<dl class="attribute">
<dt id="reikna.cbrng.tools.KeyGenerator.module">
<tt class="descname">module</tt><a class="headerlink" href="#reikna.cbrng.tools.KeyGenerator.module" title="Permalink to this definition">¶</a></dt>
<dd><p>A module with the key generator function:</p>
</dd></dl>

<dl class="function">
<dt id="key_from_int">
<a class="reference internal" href="#KEY" title="KEY">KEY</a> <tt class="descname">key_from_int</tt><big>(</big>int<em>&nbsp;idx</em><big>)</big><a class="headerlink" href="#key_from_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates and returns a key, suitable for the bijection which was given to the constructor.</p>
</dd></dl>

<dl class="classmethod">
<dt id="reikna.cbrng.tools.KeyGenerator.create">
<em class="property">classmethod </em><tt class="descname">create</tt><big>(</big><em>bijection</em>, <em>seed=None</em>, <em>reserve_id_space=True</em><big>)</big><a class="headerlink" href="#reikna.cbrng.tools.KeyGenerator.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a generator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bijection</strong> &#8211; a <a class="reference internal" href="#reikna.cbrng.bijections.Bijection" title="reikna.cbrng.bijections.Bijection"><tt class="xref py py-class docutils literal"><span class="pre">Bijection</span></tt></a> object.</li>
<li><strong>seed</strong> &#8211; an integer, or numpy array of 32-bit unsigned integers.</li>
<li><strong>reserve_id_space</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, the last 32 bit of the key will be reserved
for the thread identifier.
As a result, the total size of the key should be 64 bit or more.
If <tt class="docutils literal"><span class="pre">False</span></tt>, the thread identifier will be just added to the key,
which will still result in different keys for different threads,
with the danger that different seeds produce the same sequences.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="reikna.cbrng.tools.KeyGenerator.reference">
<tt class="descname">reference</tt><big>(</big><em>idx</em><big>)</big><a class="headerlink" href="#reikna.cbrng.tools.KeyGenerator.reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference function that returns the key given the thread identifier.
Uses the same algorithm as the module.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Computations</a><ul>
<li><a class="reference internal" href="#module-reikna.pureparallel">Pure parallel computations</a></li>
<li><a class="reference internal" href="#module-reikna.matrixmul">Linear algebra</a></li>
<li><a class="reference internal" href="#module-reikna.reduce">Algorithms</a></li>
<li><a class="reference internal" href="#fast-fourier-transform">Fast Fourier transform</a></li>
<li><a class="reference internal" href="#discrete-harmonic-transform">Discrete harmonic transform</a></li>
<li><a class="reference internal" href="#module-reikna.cbrng">Counter-based random number generators</a><ul>
<li><a class="reference internal" href="#module-reikna.cbrng.bijections">Kernel API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="core.html"
                        title="previous chapter">Core functionality</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="transformations.html"
                        title="next chapter">Transformations</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/computations.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="Transformations"
             >next</a> |</li>
        <li class="right" >
          <a href="core.html" title="Core functionality"
             >previous</a> |</li>
        <li><a href="../index.html">reikna 0.3.4 documentation</a> &raquo;</li>
          <li><a href="index.html" >API reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012-2013, Bogdan Opanchuk.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>